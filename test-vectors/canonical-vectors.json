{
  "_meta": {
    "generated_at": "2026-02-16T19:33:04.452Z",
    "protocol_version": "1.0",
    "generator": "@stele/test-vectors",
    "description": "Canonical test vectors for the Stele protocol. Any conformant implementation MUST produce identical results for these inputs.",
    "total_vectors": 56,
    "categories": [
      "crypto",
      "ccl",
      "covenant",
      "identity",
      "chain"
    ],
    "category_counts": {
      "crypto": 12,
      "ccl": 32,
      "covenant": 6,
      "identity": 3,
      "chain": 3
    }
  },
  "vectors": {
    "crypto": [
      {
        "category": "crypto",
        "name": "sha256-empty",
        "description": "SHA-256 hash of \"\"",
        "input": {
          "message": ""
        },
        "expected": {
          "hash": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
        }
      },
      {
        "category": "crypto",
        "name": "sha256-hello",
        "description": "SHA-256 hash of \"hello\"",
        "input": {
          "message": "hello"
        },
        "expected": {
          "hash": "2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824"
        }
      },
      {
        "category": "crypto",
        "name": "sha256-The-quick-brown-fox-",
        "description": "SHA-256 hash of \"The quick brown fox jumps over the lazy \"",
        "input": {
          "message": "The quick brown fox jumps over the lazy dog"
        },
        "expected": {
          "hash": "d7a8fbb307d7809469ca9abcb0082e4f8d5651e46d3cdb762d02d0bf37c9e592"
        }
      },
      {
        "category": "crypto",
        "name": "sha256---action---read---re",
        "description": "SHA-256 hash of \"{\"action\":\"read\",\"resource\":\"/data\"}\"",
        "input": {
          "message": "{\"action\":\"read\",\"resource\":\"/data\"}"
        },
        "expected": {
          "hash": "28bd65473640e1a7a72cd10d2a775b9a478e491ff54279cb5829286eeff527dd"
        }
      },
      {
        "category": "crypto",
        "name": "jcs-canonicalize-0",
        "description": "JCS (RFC 8785) canonicalization of test object 0",
        "input": {
          "object": {
            "b": 2,
            "a": 1
          }
        },
        "expected": {
          "canonical": "{\"a\":1,\"b\":2}"
        }
      },
      {
        "category": "crypto",
        "name": "jcs-canonicalize-1",
        "description": "JCS (RFC 8785) canonicalization of test object 1",
        "input": {
          "object": {
            "z": "last",
            "a": "first",
            "m": "middle"
          }
        },
        "expected": {
          "canonical": "{\"a\":\"first\",\"m\":\"middle\",\"z\":\"last\"}"
        }
      },
      {
        "category": "crypto",
        "name": "jcs-canonicalize-2",
        "description": "JCS (RFC 8785) canonicalization of test object 2",
        "input": {
          "object": {
            "nested": {
              "b": 2,
              "a": 1
            },
            "top": "value"
          }
        },
        "expected": {
          "canonical": "{\"nested\":{\"a\":1,\"b\":2},\"top\":\"value\"}"
        }
      },
      {
        "category": "crypto",
        "name": "jcs-canonicalize-3",
        "description": "JCS (RFC 8785) canonicalization of test object 3",
        "input": {
          "object": {
            "unicode": "é",
            "ascii": "e"
          }
        },
        "expected": {
          "canonical": "{\"ascii\":\"e\",\"unicode\":\"é\"}"
        }
      },
      {
        "category": "crypto",
        "name": "jcs-canonicalize-4",
        "description": "JCS (RFC 8785) canonicalization of test object 4",
        "input": {
          "object": {
            "numbers": [
              3,
              1,
              2
            ],
            "sorted": false
          }
        },
        "expected": {
          "canonical": "{\"numbers\":[3,1,2],\"sorted\":false}"
        }
      },
      {
        "category": "crypto",
        "name": "ed25519-sign-hello-world",
        "description": "Ed25519 sign/verify of \"hello world\"",
        "input": {
          "message": "hello world",
          "publicKey": "da5f816b27dfda09b8fa4ee0a7bbf3e64167e4642de8acd380be5a2d9286eeec",
          "privateKey": "ffc219d46b7cd9bd7e07037f66475c4a2bfd731bfd027cb8bafd8cc23c18b54a"
        },
        "expected": {
          "signature": "ecde12ffb2e9cbafaf112cb00202f6840b80c29c3bc8b8aac89a00969aff82ef509de3e7634947869a3b7c2bfcdf9b6f2306a34b364b37c9e2b4dcc4b7864009",
          "valid": true
        }
      },
      {
        "category": "crypto",
        "name": "ed25519-sign-The-Stele-Protocol",
        "description": "Ed25519 sign/verify of \"The Stele Protocol\"",
        "input": {
          "message": "The Stele Protocol",
          "publicKey": "da5f816b27dfda09b8fa4ee0a7bbf3e64167e4642de8acd380be5a2d9286eeec",
          "privateKey": "ffc219d46b7cd9bd7e07037f66475c4a2bfd731bfd027cb8bafd8cc23c18b54a"
        },
        "expected": {
          "signature": "fdc2efbbcd6ffcdf161e447bf821e043bec603e65cf1ac37f0d404a88d791006c6aa048ea70b53202a0f6fbcc2c74b30a354f3a7ec7125a5aa92c8971293bb02",
          "valid": true
        }
      },
      {
        "category": "crypto",
        "name": "ed25519-sign---action---read---re",
        "description": "Ed25519 sign/verify of \"{\"action\":\"read\",\"resource\":\"/data\"}\"",
        "input": {
          "message": "{\"action\":\"read\",\"resource\":\"/data\"}",
          "publicKey": "da5f816b27dfda09b8fa4ee0a7bbf3e64167e4642de8acd380be5a2d9286eeec",
          "privateKey": "ffc219d46b7cd9bd7e07037f66475c4a2bfd731bfd027cb8bafd8cc23c18b54a"
        },
        "expected": {
          "signature": "d674fd65b8bc979456793d3f8681a04bdf3065bf84f831fbd7604229129fa7f35781905d56796b8956d6ab94ebc06844160f1f5fe02070fd17cea88471c1e80e",
          "valid": true
        }
      }
    ],
    "ccl": [
      {
        "category": "ccl",
        "name": "evaluate-simple-permit",
        "description": "CCL evaluation: simple-permit",
        "input": {
          "source": "permit read on '/data/**'",
          "action": "read",
          "resource": "/data/users",
          "context": {}
        },
        "expected": {
          "permitted": true,
          "reason": "Matched permit rule for read on /data/**",
          "matchedRule": {
            "type": "permit",
            "action": "/data/**"
          }
        }
      },
      {
        "category": "ccl",
        "name": "evaluate-simple-deny",
        "description": "CCL evaluation: simple-deny",
        "input": {
          "source": "deny delete on '/system/**'",
          "action": "delete",
          "resource": "/system/config",
          "context": {}
        },
        "expected": {
          "permitted": false,
          "reason": "Matched deny rule for delete on /system/**",
          "matchedRule": {
            "type": "deny",
            "action": "/system/**"
          }
        }
      },
      {
        "category": "ccl",
        "name": "evaluate-deny-wins",
        "description": "CCL evaluation: deny-wins",
        "input": {
          "source": "permit read on '/data/**'\ndeny read on '/data/secret'",
          "action": "read",
          "resource": "/data/secret",
          "context": {}
        },
        "expected": {
          "permitted": false,
          "reason": "Matched deny rule for read on /data/secret",
          "matchedRule": {
            "type": "deny",
            "action": "/data/secret"
          }
        }
      },
      {
        "category": "ccl",
        "name": "evaluate-default-deny",
        "description": "CCL evaluation: default-deny",
        "input": {
          "source": "permit read on '/data/**'",
          "action": "write",
          "resource": "/data/users",
          "context": {}
        },
        "expected": {
          "permitted": false,
          "reason": "No matching rules found; default deny",
          "matchedRule": null
        }
      },
      {
        "category": "ccl",
        "name": "evaluate-condition-match",
        "description": "CCL evaluation: condition-match",
        "input": {
          "source": "permit read on '/data/**' when role = 'admin'",
          "action": "read",
          "resource": "/data/users",
          "context": {
            "role": "admin"
          }
        },
        "expected": {
          "permitted": true,
          "reason": "Matched permit rule for read on /data/**",
          "matchedRule": {
            "type": "permit",
            "action": "/data/**"
          }
        }
      },
      {
        "category": "ccl",
        "name": "evaluate-condition-no-match",
        "description": "CCL evaluation: condition-no-match",
        "input": {
          "source": "permit read on '/data/**' when role = 'admin'",
          "action": "read",
          "resource": "/data/users",
          "context": {
            "role": "user"
          }
        },
        "expected": {
          "permitted": false,
          "reason": "No matching rules found; default deny",
          "matchedRule": null
        }
      },
      {
        "category": "ccl",
        "name": "evaluate-wildcard-action",
        "description": "CCL evaluation: wildcard-action",
        "input": {
          "source": "permit ** on '/public/**'",
          "action": "anything.deep.nested",
          "resource": "/public/page",
          "context": {}
        },
        "expected": {
          "permitted": true,
          "reason": "Matched permit rule for ** on /public/**",
          "matchedRule": {
            "type": "permit",
            "action": "/public/**"
          }
        }
      },
      {
        "category": "ccl",
        "name": "evaluate-rate-limit-only",
        "description": "CCL evaluation: rate-limit-only",
        "input": {
          "source": "limit api.call 100 per 1 hours",
          "action": "api.call",
          "resource": "/api/endpoint",
          "context": {}
        },
        "expected": {
          "permitted": false,
          "reason": "No matching rules found; default deny",
          "matchedRule": null
        }
      },
      {
        "category": "ccl",
        "name": "evaluate-multiple-rules",
        "description": "CCL evaluation: multiple-rules",
        "input": {
          "source": "permit read on '/data/**'\npermit write on '/data/public/**'\ndeny write on '/data/private/**'",
          "action": "write",
          "resource": "/data/public/file.txt",
          "context": {}
        },
        "expected": {
          "permitted": true,
          "reason": "Matched permit rule for write on /data/public/**",
          "matchedRule": {
            "type": "permit",
            "action": "/data/public/**"
          }
        }
      },
      {
        "category": "ccl",
        "name": "evaluate-require-statement",
        "description": "CCL evaluation: require-statement",
        "input": {
          "source": "require audit on '/sensitive/**'",
          "action": "audit",
          "resource": "/sensitive/data",
          "context": {}
        },
        "expected": {
          "permitted": false,
          "reason": "No matching rules found; default deny",
          "matchedRule": null
        }
      },
      {
        "category": "ccl",
        "name": "action-match-read-vs-read",
        "description": "Action matching: \"read\" vs \"read\"",
        "input": {
          "pattern": "read",
          "action": "read"
        },
        "expected": {
          "matches": true
        }
      },
      {
        "category": "ccl",
        "name": "action-match-read-vs-write",
        "description": "Action matching: \"read\" vs \"write\"",
        "input": {
          "pattern": "read",
          "action": "write"
        },
        "expected": {
          "matches": false
        }
      },
      {
        "category": "ccl",
        "name": "action-match-*-vs-read",
        "description": "Action matching: \"*\" vs \"read\"",
        "input": {
          "pattern": "*",
          "action": "read"
        },
        "expected": {
          "matches": true
        }
      },
      {
        "category": "ccl",
        "name": "action-match-**-vs-api.call.nested",
        "description": "Action matching: \"**\" vs \"api.call.nested\"",
        "input": {
          "pattern": "**",
          "action": "api.call.nested"
        },
        "expected": {
          "matches": true
        }
      },
      {
        "category": "ccl",
        "name": "action-match-api.*-vs-api.call",
        "description": "Action matching: \"api.*\" vs \"api.call\"",
        "input": {
          "pattern": "api.*",
          "action": "api.call"
        },
        "expected": {
          "matches": true
        }
      },
      {
        "category": "ccl",
        "name": "action-match-api.*-vs-api.call.nested",
        "description": "Action matching: \"api.*\" vs \"api.call.nested\"",
        "input": {
          "pattern": "api.*",
          "action": "api.call.nested"
        },
        "expected": {
          "matches": false
        }
      },
      {
        "category": "ccl",
        "name": "action-match-api.**-vs-api.call.nested",
        "description": "Action matching: \"api.**\" vs \"api.call.nested\"",
        "input": {
          "pattern": "api.**",
          "action": "api.call.nested"
        },
        "expected": {
          "matches": true
        }
      },
      {
        "category": "ccl",
        "name": "resource-match--data-vs--data",
        "description": "Resource matching: \"/data\" vs \"/data\"",
        "input": {
          "pattern": "/data",
          "resource": "/data"
        },
        "expected": {
          "matches": true
        }
      },
      {
        "category": "ccl",
        "name": "resource-match--data-vs--data-sub",
        "description": "Resource matching: \"/data\" vs \"/data/sub\"",
        "input": {
          "pattern": "/data",
          "resource": "/data/sub"
        },
        "expected": {
          "matches": false
        }
      },
      {
        "category": "ccl",
        "name": "resource-match--data-starstar-vs--data-sub-deep",
        "description": "Resource matching: \"/data/**\" vs \"/data/sub/deep\"",
        "input": {
          "pattern": "/data/**",
          "resource": "/data/sub/deep"
        },
        "expected": {
          "matches": true
        }
      },
      {
        "category": "ccl",
        "name": "resource-match--data-star-vs--data-sub",
        "description": "Resource matching: \"/data/*\" vs \"/data/sub\"",
        "input": {
          "pattern": "/data/*",
          "resource": "/data/sub"
        },
        "expected": {
          "matches": true
        }
      },
      {
        "category": "ccl",
        "name": "resource-match--data-star-vs--data-sub-deep",
        "description": "Resource matching: \"/data/*\" vs \"/data/sub/deep\"",
        "input": {
          "pattern": "/data/*",
          "resource": "/data/sub/deep"
        },
        "expected": {
          "matches": false
        }
      },
      {
        "category": "ccl",
        "name": "resource-match-starstar-vs--anything-at-all",
        "description": "Resource matching: \"**\" vs \"/anything/at/all\"",
        "input": {
          "pattern": "**",
          "resource": "/anything/at/all"
        },
        "expected": {
          "matches": true
        }
      },
      {
        "category": "ccl",
        "name": "rate-limit-under-limit",
        "description": "Rate limiting: under-limit",
        "input": {
          "source": "limit api.call 100 per 1 hours",
          "action": "api.call",
          "currentCount": 50,
          "periodStartMs": 1771270383383,
          "nowMs": 1771270384383
        },
        "expected": {
          "exceeded": false,
          "remaining": 50
        }
      },
      {
        "category": "ccl",
        "name": "rate-limit-at-limit",
        "description": "Rate limiting: at-limit",
        "input": {
          "source": "limit api.call 100 per 1 hours",
          "action": "api.call",
          "currentCount": 100,
          "periodStartMs": 1771270383383,
          "nowMs": 1771270384383
        },
        "expected": {
          "exceeded": true,
          "remaining": 0
        }
      },
      {
        "category": "ccl",
        "name": "rate-limit-over-limit",
        "description": "Rate limiting: over-limit",
        "input": {
          "source": "limit api.call 100 per 1 hours",
          "action": "api.call",
          "currentCount": 150,
          "periodStartMs": 1771270383383,
          "nowMs": 1771270384383
        },
        "expected": {
          "exceeded": true,
          "remaining": 0
        }
      },
      {
        "category": "ccl",
        "name": "rate-limit-period-expired",
        "description": "Rate limiting: period-expired",
        "input": {
          "source": "limit api.call 100 per 1 hours",
          "action": "api.call",
          "currentCount": 150,
          "periodStartMs": 1771266784382,
          "nowMs": 1771270384383
        },
        "expected": {
          "exceeded": false,
          "remaining": 100
        }
      },
      {
        "category": "ccl",
        "name": "serialize-permit-read-on---data----",
        "description": "CCL serialize round-trip: \"permit read on '/data/**'\"",
        "input": {
          "source": "permit read on '/data/**'"
        },
        "expected": {
          "serialized": "permit read on '/data/**'"
        }
      },
      {
        "category": "ccl",
        "name": "serialize-deny-delete-on---system----",
        "description": "CCL serialize round-trip: \"deny delete on '/system/**'\"",
        "input": {
          "source": "deny delete on '/system/**'"
        },
        "expected": {
          "serialized": "deny delete on '/system/**'"
        }
      },
      {
        "category": "ccl",
        "name": "serialize-permit-read-on---data-----when",
        "description": "CCL serialize round-trip: \"permit read on '/data/**' when role = 'a\"",
        "input": {
          "source": "permit read on '/data/**' when role = 'admin'"
        },
        "expected": {
          "serialized": "permit read on '/data/**' when role = 'admin'"
        }
      },
      {
        "category": "ccl",
        "name": "serialize-limit-api-call-100-per-1-hours",
        "description": "CCL serialize round-trip: \"limit api.call 100 per 1 hours\"",
        "input": {
          "source": "limit api.call 100 per 1 hours"
        },
        "expected": {
          "serialized": "limit api.call 100 per 1 hours"
        }
      },
      {
        "category": "ccl",
        "name": "serialize-require-audit-on---sensitive--",
        "description": "CCL serialize round-trip: \"require audit on '/sensitive/**'\"",
        "input": {
          "source": "require audit on '/sensitive/**'"
        },
        "expected": {
          "serialized": "require audit on '/sensitive/**'"
        }
      }
    ],
    "covenant": [
      {
        "category": "covenant",
        "name": "build-basic",
        "description": "Build a basic covenant document and capture intermediate values",
        "input": {
          "issuer": {
            "id": "test-issuer",
            "publicKey": "da5f816b27dfda09b8fa4ee0a7bbf3e64167e4642de8acd380be5a2d9286eeec",
            "role": "issuer"
          },
          "beneficiary": {
            "id": "test-beneficiary",
            "publicKey": "daf58dcdb9e85810fbce85b9bb4adecb1b432fbd19e0c85be4343a4b8c35288a",
            "role": "beneficiary"
          },
          "constraints": "permit read on '/data/**'\ndeny delete on '/system/**'",
          "signerPrivateKey": "ffc219d46b7cd9bd7e07037f66475c4a2bfd731bfd027cb8bafd8cc23c18b54a"
        },
        "expected": {
          "version": "1.0",
          "id": "c7430342a08e0d9d19ea536f7fe315e4e419fd0425d1412bb18bee0946b51400",
          "canonical_form": "{\"beneficiary\":{\"id\":\"test-beneficiary\",\"publicKey\":\"daf58dcdb9e85810fbce85b9bb4adecb1b432fbd19e0c85be4343a4b8c35288a\",\"role\":\"beneficiary\"},\"constraints\":\"permit read on '/data/**'\\ndeny delete on '/system/**'\",\"createdAt\":\"2026-02-16T19:33:04.385Z\",\"issuer\":{\"id\":\"test-issuer\",\"publicKey\":\"da5f816b27dfda09b8fa4ee0a7bbf3e64167e4642de8acd380be5a2d9286eeec\",\"role\":\"issuer\"},\"nonce\":\"35fb92aab285b44a0ad2de0bcbcf70297ab7e88daa3b34cd764381eeee6b2ec6\",\"version\":\"1.0\"}",
          "canonical_hash_matches_id": true,
          "nonce": "35fb92aab285b44a0ad2de0bcbcf70297ab7e88daa3b34cd764381eeee6b2ec6",
          "nonce_length": 64,
          "signature": "ea277317f8d5e9bc1f768d84fe613253463d6dabdf9cc2c978d122d8beb83d3822108c6d5f4507a0c2b7eeae3adfbd6c06aeeeee163dd8cd465801b1a075e40c",
          "createdAt": "2026-02-16T19:33:04.385Z"
        }
      },
      {
        "category": "covenant",
        "name": "verify-valid",
        "description": "Verify a valid covenant document -- all 11 checks should pass",
        "input": {
          "document": {
            "id": "c7430342a08e0d9d19ea536f7fe315e4e419fd0425d1412bb18bee0946b51400",
            "version": "1.0",
            "issuer": {
              "id": "test-issuer",
              "publicKey": "da5f816b27dfda09b8fa4ee0a7bbf3e64167e4642de8acd380be5a2d9286eeec",
              "role": "issuer"
            },
            "beneficiary": {
              "id": "test-beneficiary",
              "publicKey": "daf58dcdb9e85810fbce85b9bb4adecb1b432fbd19e0c85be4343a4b8c35288a",
              "role": "beneficiary"
            },
            "constraints": "permit read on '/data/**'\ndeny delete on '/system/**'",
            "nonce": "35fb92aab285b44a0ad2de0bcbcf70297ab7e88daa3b34cd764381eeee6b2ec6",
            "createdAt": "2026-02-16T19:33:04.385Z",
            "signature": "ea277317f8d5e9bc1f768d84fe613253463d6dabdf9cc2c978d122d8beb83d3822108c6d5f4507a0c2b7eeae3adfbd6c06aeeeee163dd8cd465801b1a075e40c"
          }
        },
        "expected": {
          "valid": true,
          "checks": [
            {
              "name": "id_match",
              "passed": true
            },
            {
              "name": "signature_valid",
              "passed": true
            },
            {
              "name": "not_expired",
              "passed": true
            },
            {
              "name": "active",
              "passed": true
            },
            {
              "name": "ccl_parses",
              "passed": true
            },
            {
              "name": "enforcement_valid",
              "passed": true
            },
            {
              "name": "proof_valid",
              "passed": true
            },
            {
              "name": "chain_depth",
              "passed": true
            },
            {
              "name": "document_size",
              "passed": true
            },
            {
              "name": "countersignatures",
              "passed": true
            },
            {
              "name": "nonce_present",
              "passed": true
            }
          ]
        }
      },
      {
        "category": "covenant",
        "name": "verify-tampered-signature",
        "description": "Verify a covenant with tampered signature (should fail)",
        "input": {
          "document": {
            "id": "c7430342a08e0d9d19ea536f7fe315e4e419fd0425d1412bb18bee0946b51400",
            "version": "1.0",
            "issuer": {
              "id": "test-issuer",
              "publicKey": "da5f816b27dfda09b8fa4ee0a7bbf3e64167e4642de8acd380be5a2d9286eeec",
              "role": "issuer"
            },
            "beneficiary": {
              "id": "test-beneficiary",
              "publicKey": "daf58dcdb9e85810fbce85b9bb4adecb1b432fbd19e0c85be4343a4b8c35288a",
              "role": "beneficiary"
            },
            "constraints": "permit read on '/data/**'\ndeny delete on '/system/**'",
            "nonce": "35fb92aab285b44a0ad2de0bcbcf70297ab7e88daa3b34cd764381eeee6b2ec6",
            "createdAt": "2026-02-16T19:33:04.385Z",
            "signature": "0a277317f8d5e9bc1f768d84fe613253463d6dabdf9cc2c978d122d8beb83d3822108c6d5f4507a0c2b7eeae3adfbd6c06aeeeee163dd8cd465801b1a075e40c"
          },
          "tamper": "first character of signature modified"
        },
        "expected": {
          "valid": false,
          "failed_checks": [
            "signature_valid"
          ]
        }
      },
      {
        "category": "covenant",
        "name": "verify-tampered-constraints",
        "description": "Verify a covenant with tampered constraints (should fail id_match and signature)",
        "input": {
          "document": {
            "id": "c7430342a08e0d9d19ea536f7fe315e4e419fd0425d1412bb18bee0946b51400",
            "version": "1.0",
            "issuer": {
              "id": "test-issuer",
              "publicKey": "da5f816b27dfda09b8fa4ee0a7bbf3e64167e4642de8acd380be5a2d9286eeec",
              "role": "issuer"
            },
            "beneficiary": {
              "id": "test-beneficiary",
              "publicKey": "daf58dcdb9e85810fbce85b9bb4adecb1b432fbd19e0c85be4343a4b8c35288a",
              "role": "beneficiary"
            },
            "constraints": "permit write on '/data/**'",
            "nonce": "35fb92aab285b44a0ad2de0bcbcf70297ab7e88daa3b34cd764381eeee6b2ec6",
            "createdAt": "2026-02-16T19:33:04.385Z",
            "signature": "ea277317f8d5e9bc1f768d84fe613253463d6dabdf9cc2c978d122d8beb83d3822108c6d5f4507a0c2b7eeae3adfbd6c06aeeeee163dd8cd465801b1a075e40c"
          },
          "tamper": "constraints modified after signing"
        },
        "expected": {
          "valid": false,
          "failed_checks": [
            "id_match",
            "signature_valid"
          ]
        }
      },
      {
        "category": "covenant",
        "name": "countersign",
        "description": "Countersign a covenant document with an auditor",
        "input": {
          "document_id": "c7430342a08e0d9d19ea536f7fe315e4e419fd0425d1412bb18bee0946b51400",
          "signerPublicKey": "bcd7d1dea97ab056fa4f11a091565b602139be3d6c23e4b371ce26f0f1606b91",
          "signerPrivateKey": "939c37f9b6236cad70c7f6c5d1d8eb1680ea42dc9ae84b00a9028fdc294fc064",
          "signerRole": "auditor"
        },
        "expected": {
          "countersignature_count": 1,
          "countersigner_role": "auditor",
          "countersigner_publicKey": "bcd7d1dea97ab056fa4f11a091565b602139be3d6c23e4b371ce26f0f1606b91",
          "countersignature_signature": "5b7df8bf1e8a4d7df37e3e25a8e3c630cf28ee7f099af0468834ffdacbfc777acefe9528258cbb1f9df4abeef86f57f49a580b4d74d49ae83b6f60b75e3bff0c"
        }
      },
      {
        "category": "covenant",
        "name": "verify-countersigned",
        "description": "Verify a countersigned covenant document",
        "input": {
          "document": {
            "id": "c7430342a08e0d9d19ea536f7fe315e4e419fd0425d1412bb18bee0946b51400",
            "version": "1.0",
            "issuer": {
              "id": "test-issuer",
              "publicKey": "da5f816b27dfda09b8fa4ee0a7bbf3e64167e4642de8acd380be5a2d9286eeec",
              "role": "issuer"
            },
            "beneficiary": {
              "id": "test-beneficiary",
              "publicKey": "daf58dcdb9e85810fbce85b9bb4adecb1b432fbd19e0c85be4343a4b8c35288a",
              "role": "beneficiary"
            },
            "constraints": "permit read on '/data/**'\ndeny delete on '/system/**'",
            "nonce": "35fb92aab285b44a0ad2de0bcbcf70297ab7e88daa3b34cd764381eeee6b2ec6",
            "createdAt": "2026-02-16T19:33:04.385Z",
            "signature": "ea277317f8d5e9bc1f768d84fe613253463d6dabdf9cc2c978d122d8beb83d3822108c6d5f4507a0c2b7eeae3adfbd6c06aeeeee163dd8cd465801b1a075e40c",
            "countersignatures": [
              {
                "signerPublicKey": "bcd7d1dea97ab056fa4f11a091565b602139be3d6c23e4b371ce26f0f1606b91",
                "signerRole": "auditor",
                "signature": "5b7df8bf1e8a4d7df37e3e25a8e3c630cf28ee7f099af0468834ffdacbfc777acefe9528258cbb1f9df4abeef86f57f49a580b4d74d49ae83b6f60b75e3bff0c",
                "timestamp": "2026-02-16T19:33:04.405Z"
              }
            ]
          }
        },
        "expected": {
          "valid": true,
          "checks": [
            {
              "name": "id_match",
              "passed": true
            },
            {
              "name": "signature_valid",
              "passed": true
            },
            {
              "name": "not_expired",
              "passed": true
            },
            {
              "name": "active",
              "passed": true
            },
            {
              "name": "ccl_parses",
              "passed": true
            },
            {
              "name": "enforcement_valid",
              "passed": true
            },
            {
              "name": "proof_valid",
              "passed": true
            },
            {
              "name": "chain_depth",
              "passed": true
            },
            {
              "name": "document_size",
              "passed": true
            },
            {
              "name": "countersignatures",
              "passed": true
            },
            {
              "name": "nonce_present",
              "passed": true
            }
          ]
        }
      }
    ],
    "identity": [
      {
        "category": "identity",
        "name": "create-basic",
        "description": "Create a basic agent identity",
        "input": {
          "operatorPublicKey": "da5f816b27dfda09b8fa4ee0a7bbf3e64167e4642de8acd380be5a2d9286eeec",
          "operatorPrivateKey": "ffc219d46b7cd9bd7e07037f66475c4a2bfd731bfd027cb8bafd8cc23c18b54a",
          "operatorIdentifier": "test-operator",
          "model": {
            "provider": "anthropic",
            "modelId": "claude-3"
          },
          "capabilities": [
            "read",
            "write",
            "api.call"
          ],
          "deployment": {
            "runtime": "container"
          }
        },
        "expected": {
          "id": "4d9e5e2e0ae8833584103a1ab84153386cec356c37a7526538ba59dd81b4a52c",
          "has_id": true,
          "model_provider": "anthropic",
          "model_modelId": "claude-3",
          "capabilities_sorted": [
            "api.call",
            "read",
            "write"
          ],
          "capabilities_count": 3,
          "capabilityManifestHash": "6f2b84d3b305a1a1a9c05809ebc94f13d4221029353edcff808072f176dece25",
          "lineage_length": 1,
          "lineage_first_changeType": "created",
          "lineage_first_reputationCarryForward": 1,
          "version": 1,
          "signature": "99eba6bb13890af366e6625405e4f4d38e10e605979a2e84800580e538338b038e147529a193cc3a8e02093b0513636470eaa70d7e8af12bf4b99744dec3ee06"
        }
      },
      {
        "category": "identity",
        "name": "evolve-model-update",
        "description": "Evolve an identity with a model update",
        "input": {
          "originalIdentityId": "4d9e5e2e0ae8833584103a1ab84153386cec356c37a7526538ba59dd81b4a52c",
          "operatorPublicKey": "da5f816b27dfda09b8fa4ee0a7bbf3e64167e4642de8acd380be5a2d9286eeec",
          "operatorPrivateKey": "ffc219d46b7cd9bd7e07037f66475c4a2bfd731bfd027cb8bafd8cc23c18b54a",
          "changeType": "model_update",
          "description": "Upgraded to claude-4",
          "updates": {
            "model": {
              "provider": "anthropic",
              "modelId": "claude-4"
            }
          }
        },
        "expected": {
          "new_id": "f4da34bc3873b2026a668376d2bc517035ccdc6bb6b146ec4d0828353c0e0bd6",
          "new_id_differs": true,
          "model_updated": true,
          "model_provider": "anthropic",
          "lineage_grew": true,
          "lineage_length": 2,
          "latest_changeType": "model_update",
          "latest_parentHash": "fdcf44ee97693f6f8ea4dd7565151d09ab55c4847016b6ee75dd3c76a06ab3da",
          "version": 2,
          "signature": "fc001068f1bdf6ad5a9e6f9a6772085be4c3764b60379414c1b108e54b0c8d9f1675d1eb2af07caf3340e6af96faee661c3067ac8f343c898dab644a98e29609"
        }
      },
      {
        "category": "identity",
        "name": "evolve-capability-change",
        "description": "Evolve an identity with a capability expansion",
        "input": {
          "originalIdentityId": "4d9e5e2e0ae8833584103a1ab84153386cec356c37a7526538ba59dd81b4a52c",
          "changeType": "capability_change",
          "updates": {
            "capabilities": [
              "read",
              "write",
              "api.call",
              "admin"
            ]
          }
        },
        "expected": {
          "new_id": "e146b2d177a1cc6771df7ebd9290300ca0ccb6bb558dbc7216443266fc4d856a",
          "capabilities_sorted": [
            "admin",
            "api.call",
            "read",
            "write"
          ],
          "capabilities_count": 4,
          "capabilityManifestHash": "f5d317d3294f8564f4834d8dd9afc26b17e1d2d9e1eb468a7f7a0840bafb2580",
          "lineage_length": 2,
          "latest_reputationCarryForward": 0.9
        }
      }
    ],
    "chain": [
      {
        "category": "chain",
        "name": "valid-narrowing",
        "description": "Child narrows parent permissions (valid delegation)",
        "input": {
          "parentConstraints": "permit read on '/data/**'\npermit write on '/data/**'",
          "childConstraints": "permit read on '/data/public/**'",
          "childChain": {
            "parentId": "24fb73c6922da87790d2010f15aa1d65c73f9345e91175614366cfefb6cbe43f",
            "relation": "delegates",
            "depth": 1
          }
        },
        "expected": {
          "valid": true,
          "violations_count": 0
        }
      },
      {
        "category": "chain",
        "name": "invalid-broadening",
        "description": "Child broadens parent permissions (invalid -- permits what parent denies)",
        "input": {
          "parentConstraints": "permit read on '/data/**'\ndeny write on '/data/private/**'",
          "childConstraints": "permit write on '/data/private/**'"
        },
        "expected": {
          "valid": false,
          "violations_count": 2,
          "violation_reasons": [
            "Child permits 'write' on '/data/private/**' which parent denies",
            "Child permit 'write' on '/data/private/**' is not a subset of any parent permit"
          ]
        }
      },
      {
        "category": "chain",
        "name": "outside-parent-scope",
        "description": "Child permits resources outside parent scope (invalid)",
        "input": {
          "parentConstraints": "permit read on '/data/**'\npermit write on '/data/**'",
          "childConstraints": "permit read on '/admin/**'"
        },
        "expected": {
          "valid": false,
          "violations_count": 1,
          "violation_reasons": [
            "Child permit 'read' on '/admin/**' is not a subset of any parent permit"
          ]
        }
      }
    ]
  }
}